import numpy as np
import pandas as pd


ser = pd.Series(range(5), index = list("abcde"))

res = ser.loc[["a","b","c"]]

print(res)

# Output:

# a    0
# b    1
# c    2
# dtype: int64

dates = pd.date_range("1/1/2000", periods=8)

df = pd.DataFrame(10 + 10 * np.random.randn(8,4), index=dates, columns=list("ABCD"))

df = df.round(0)
print("Dataframe = ")
print(df)

# Output:
#                   A         B         C         D
# 2000-01-01  0.033694 -1.047442  1.650475  1.558974
# 2000-01-02 -0.076581 -0.369351 -0.790767  0.056969
# 2000-01-03 -1.190236  0.296583 -0.907616  0.636163
# 2000-01-04  2.369955 -0.328096  1.104147 -0.650021
# 2000-01-05  0.454950  1.018332  0.250289  1.172936
# 2000-01-06  2.668225 -1.018242 -0.786779 -0.728135
# 2000-01-07  0.904382  0.171667 -1.199620  0.318404
# 2000-01-08 -1.134834  0.662738 -0.040487  0.649014

df[['A','B']] = df[['B','A']]

print(df)

# Output:
#             A         B         C         D
# 2000-01-01 -0.061786 -1.801308 -0.594343 -1.767704
# 2000-01-02 -1.727075 -0.387171 -0.706472  0.495098
# 2000-01-03  0.997133  1.492225  1.110377  0.328963
# 2000-01-04 -0.951424  1.284132 -0.345414 -0.633079
# 2000-01-05  0.129790 -0.336311  0.882442 -0.545958
# 2000-01-06 -1.141861  0.296524 -0.733546 -0.634465
# 2000-01-07 -1.061657 -0.308623  1.102571  0.232834
# 2000-01-08 -0.420429 -0.738930 -1.605921  0.298777


# ==============================================  Properly Swapped
df[['A','B']]

print('Original:')
print(df)

df.loc[:, ['B','A']] = df[['A','B']].to_numpy()

print("Properly Swapped Using .loc = ")
print(df[['A','B']])

# Output:
# Original:
#                A     B     C     D
# 2000-01-01   9.0   7.0  16.0  15.0
# 2000-01-02   9.0   8.0   7.0   9.0
# 2000-01-03  11.0   6.0   5.0   7.0
# 2000-01-04  -5.0   7.0  10.0  24.0
# 2000-01-05  16.0 -10.0  13.0  37.0
# 2000-01-06  23.0  -5.0   1.0  14.0
# 2000-01-07  19.0  11.0  11.0  -1.0
# 2000-01-08  10.0   4.0   4.0   5.0
# Properly Swapped Using .loc =
#                A     B
# 2000-01-01   7.0   9.0
# 2000-01-02   8.0   9.0
# 2000-01-03   6.0  11.0
# 2000-01-04   7.0  -5.0
# 2000-01-05 -10.0  16.0
# 2000-01-06  -5.0  23.0
# 2000-01-07  11.0  19.0
# 2000-01-08   4.0  10.0

df.iloc[:, [1,0]] = df[['A','B']]

print(df[['A','B']])

# Output:
#          A     B
# 2000-01-01   9.0   7.0
# 2000-01-02   9.0   8.0
# 2000-01-03  11.0   6.0
# 2000-01-04  -5.0   7.0
# 2000-01-05  16.0 -10.0
# 2000-01-06  23.0  -5.0
# 2000-01-07  19.0  11.0
# 2000-01-08  10.0   4.0

# =====================================================  Boolean Indexing ==================================

s = pd.Series(range(-3, 4))
print(s)

# Output:
# 0   -3
# 1   -2
# 2   -1
# 3    0
# 4    1
# 5    2
# 6    3
# dtype: int64

print(s[s > 0])

# Output:
# 4    1
# 5    2
# 6    3
# dtype: int64

print(s[(s>0) & (s<3)])
# Output:
# 4    1
# 5    2
# dtype: int64
print(s[(s>0) | (s<3)])

# Output:
# 0   -3
# 1   -2
# 2   -1
# 3    0
# 4    1
# 5    2
# 6    3
# dtype: int64
print("With Dataframes = ")
print(df[df['A'] > 0])

# Output:
#                A     B     C     D
# 2000-01-01  12.0  10.0   8.0   8.0
# 2000-01-02  18.0  11.0   1.0   1.0
# 2000-01-03  13.0   6.0  19.0  23.0
# 2000-01-04  19.0  28.0  -6.0  18.0
# 2000-01-06   9.0   4.0  13.0   2.0
# 2000-01-07   4.0  -1.0  20.0  26.0
# 2000-01-08  19.0  11.0   5.0   4.0

print("Conditional = ")
print((df['A'] > 0) & (df['B'] >2))

# Output:
#           A     B     C     D
# 2000-01-01   6.0  11.0  17.0  23.0
# 2000-01-03  12.0  17.0  -4.0   8.0
# 2000-01-04  13.0   8.0   9.0   1.0
# 2000-01-06   9.0  25.0  18.0  38.0
# 2000-01-07   1.0  13.0  21.0  11.0
# Conditional =
# 2000-01-01     True
# 2000-01-02    False
# 2000-01-03     True
# 2000-01-04     True
# 2000-01-05    False
# 2000-01-06     True
# 2000-01-07     True
# 2000-01-08    False
print("S = ")
print(s)
print("Use of iat ")
print(s.iat[5])


print("Original DF = ")
print(df)
print("It is the 6th element of A column =", df.at[dates[5], 'A'])
print("It is the 4th element of 0th column =", df.iat[3,0])

